# SPLIT-PLAN-003: Build and Utilities
## Split 003 of 5: Build Operations and Utility Functions
**Planner**: Code Reviewer code-reviewer-1757726063 (sole planner for ALL splits)
**Parent Effort**: kind-cert-extraction

<!-- ORCHESTRATOR METADATA PLACEHOLDER - DO NOT REMOVE -->
<!-- The orchestrator will add infrastructure metadata below: -->
<!-- WORKING_DIRECTORY, BRANCH, REMOTE, BASE_BRANCH, etc. -->
<!-- SW Engineers MUST read this metadata to navigate to the correct directory -->
<!-- END PLACEHOLDER -->

## Boundaries (CRITICAL: All splits MUST reference SAME effort!)
- **Previous Split**: Split 002 of phase1/wave1/kind-cert-extraction
  - Path: efforts/phase1/wave1/kind-cert-extraction/split-002/
  - Branch: idpbuilder-oci-build-push/phase1/wave1/kind-cert-extraction-split-002
  - Summary: Kind cluster and Kubernetes operations
- **This Split**: Split 003 of phase1/wave1/kind-cert-extraction
  - Path: efforts/phase1/wave1/kind-cert-extraction/split-003/
  - Branch: idpbuilder-oci-build-push/phase1/wave1/kind-cert-extraction-split-003
- **Next Split**: Split 004 of phase1/wave1/kind-cert-extraction
  - Path: efforts/phase1/wave1/kind-cert-extraction/split-004/
  - Branch: idpbuilder-oci-build-push/phase1/wave1/kind-cert-extraction-split-004
- **File Boundaries**:
  - This Split Start: pkg/build/build.go
  - This Split End: pkg/util/ (all files)
  - Next Split Start: pkg/cmd/root.go

## Files in This Split (EXCLUSIVE - no overlap with other splits)
### Build Package (pkg/build/)
- pkg/build/build.go (~295 lines)
- pkg/build/tls.go (~225 lines)
- pkg/build/artifacts.go (~80 lines)
- Test files for build package

### Utilities Package (pkg/util/)
- pkg/util/util.go (~185 lines)
- pkg/util/url.go (~187 lines)
- pkg/util/git_repository.go (~270 lines)
- pkg/util/validators.go (~60 lines)
- Test files for util package

## Functionality
This split provides build operations and utility functions:
- Build orchestration and artifact management
- TLS certificate handling and validation
- URL parsing and validation utilities
- Git repository operations
- General utility functions
- Validation helpers

## Dependencies
- **Split 001**: Uses certificate types and storage
- **Split 002**: Uses Kind cluster operations
- Builds on interfaces from previous splits

## Implementation Instructions
1. **Setup**:
   ```bash
   # Branch from Split 002
   cd efforts/phase1/wave1/kind-cert-extraction/split-003
   git checkout -b idpbuilder-oci-build-push/phase1/wave1/kind-cert-extraction-split-003
   
   # Merge previous splits
   git merge [split-002-branch]
   ```

2. **Implementation**:
   - Implement complete pkg/build package
   - Implement complete pkg/util package
   - Add TLS certificate handling
   - Implement Git repository utilities
   - Add URL validation and parsing

3. **Integration**:
   - Use certificate types from Split 001
   - Integrate with Kind operations from Split 002
   - Provide utilities for later splits
   - Maintain backward compatibility

4. **Testing**:
   - Unit tests for all utilities
   - Test TLS operations
   - Mock external dependencies
   - Validate edge cases

5. **Validation**:
   ```bash
   # Measure size
   $PROJECT_ROOT/tools/line-counter.sh
   
   # Run tests
   go test ./pkg/build/... ./pkg/util/...
   
   # Build verification
   go build ./...
   ```

## Size Management
- **Target Size**: 620 lines
- **Hard Limit**: 800 lines
- **Measurement**: Use ${PROJECT_ROOT}/tools/line-counter.sh
- **Excluded**: Test files, generated code

## Feature Flags
- `BUILD_OPS_ENABLED`: Enable build operations
- `TLS_VALIDATION_ENABLED`: Enable TLS validation
- Graceful degradation when disabled

## Quality Requirements
- Clean utility functions with single responsibility
- No stub implementations (R320)
- Test coverage >80%
- Proper error handling
- Clear function documentation

## Integration Points
This split provides for other splits:
- Build orchestration capabilities
- TLS certificate operations
- URL parsing and validation
- Git repository utilities
- Common validation functions

## Success Criteria
- ✅ Complete build operations implementation
- ✅ All utilities fully functional
- ✅ Tests passing with >80% coverage
- ✅ Size under 700 lines
- ✅ No stub implementations
- ✅ Proper integration with Splits 001-002
- ✅ Feature flags working correctly