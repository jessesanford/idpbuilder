# Effort Implementation Plan: [EFFORT_NAME]

<!-- STORAGE LOCATION: This plan should be saved in:
     .software-factory/phase[X]/wave[Y]/[effort-name]/IMPLEMENTATION-PLAN-YYYYMMDD-HHMMSS.md
     within the effort's working directory. This keeps plans organized and separate from code. -->

<!-- NOTE: [PROJECT_PREFIX/] should be replaced with the actual project prefix from target-repo-config.yaml 
     If project_prefix is "tmc-workspace", branches become: tmc-workspace/phase1/wave1/effort-name
     If project_prefix is empty, branches become: phase1/wave1/effort-name -->

## üö® CRITICAL EFFORT METADATA (FROM WAVE PLAN)
**Effort**: [EFFORT_NUMBER] - [EFFORT_NAME]  
**Branch**: `[PROJECT_PREFIX/]phase[PHASE]/wave[WAVE]/effort-[name]`  
**Can Parallelize**: [Yes/No] (COPIED FROM WAVE PLAN)  
**Parallel With**: [List effort numbers or "None"] (COPIED FROM WAVE PLAN)  
**Size Estimate**: [NUMBER] lines (MUST be <800)  
**Dependencies**: [List dependent efforts] (COPIED FROM WAVE PLAN)  
**Atomic PR**: ‚úÖ This effort = ONE PR to main (R220 REQUIREMENT)  

## üìã Source Information
**Wave Plan**: PHASE-[PHASE]-WAVE-[WAVE]-IMPLEMENTATION-PLAN.md  
**Effort Section**: Effort [NUMBER]  
**Created By**: Code Reviewer Agent  
**Date**: [DATE]  
**Extracted**: [TIMESTAMP]  

## üöÄ Parallelization Context
**Can Parallelize**: [Yes/No]  
**Parallel With**: [Efforts that can run simultaneously]  
**Blocking Status**: [If No - this effort blocks: X, Y, Z]  
**Parallel Group**: [If Yes - member of parallel group: A, B, C]  
**Orchestrator Guidance**: [When orchestrator should spawn this effort]  

## üö® EXPLICIT SCOPE DEFINITION (R311 MANDATORY)

### IMPLEMENT EXACTLY (BE SPECIFIC!)

#### Functions to Create (EXACTLY [N] - NO MORE)
```go
1. FunctionName1(params) ReturnType    // ~[X] lines - [specific purpose]
2. FunctionName2(params) ReturnType    // ~[Y] lines - [specific purpose]  
3. FunctionName3(params) ReturnType    // ~[Z] lines - [specific purpose]
// STOP HERE - DO NOT ADD MORE FUNCTIONS
```

#### Types/Structs to Define (EXACTLY [N])
```go
// Type 1: Core data model
type ModelName struct {
    Field1 string  // [purpose]
    Field2 int     // [purpose]
    // EXACTLY these fields, NO methods in this effort
}

// Type 2: Service interface
type ServiceInterface interface {
    Method1(ctx context.Context) error  // Required
    Method2(id string) (*Model, error)  // Required
    // NO additional methods
}
```

#### Endpoints/Handlers (if applicable)
```go
// EXACTLY these endpoints:
POST   /api/v1/resource   // CreateResource handler - ~100 lines
GET    /api/v1/resource   // GetResource handler - ~80 lines
// NO additional endpoints (no DELETE, PUT, etc.)
```

### üõë DO NOT IMPLEMENT (SCOPE BOUNDARIES)

**EXPLICITLY FORBIDDEN IN THIS EFFORT:**
- ‚ùå DO NOT add validation beyond basic nil/empty checks
- ‚ùå DO NOT implement Update/Delete operations (future effort)
- ‚ùå DO NOT add caching or optimization (future effort)
- ‚ùå DO NOT implement authentication/authorization (separate effort)
- ‚ùå DO NOT add comprehensive error handling (basic only)
- ‚ùå DO NOT create helper/utility functions not listed above
- ‚ùå DO NOT refactor or "improve" existing code
- ‚ùå DO NOT add logging beyond critical errors
- ‚ùå DO NOT write performance tests or benchmarks
- ‚ùå DO NOT implement nice-to-have features

### üìä REALISTIC SIZE CALCULATION

```
Component Breakdown:
- Function 1:                    [X] lines
- Function 2:                    [Y] lines
- Function 3:                    [Z] lines
- Type definitions:             [A] lines
- Basic tests (N √ó 30):        [B] lines
- Integration setup:           [C] lines

TOTAL ESTIMATE: [SUM] lines (must be <800)
BUFFER: [800-SUM] lines for unforeseen needs
```

## üìÅ Files to Create

### Primary Implementation Files
```yaml
new_files:
  - path: pkg/phase[PHASE]/wave[WAVE]/[feature]/[file1].go
    lines: ~[NUMBER] MAX
    purpose: [SPECIFIC PURPOSE]
    contains:
      - FunctionName1 (NO additional functions)
      - TypeName1 (NO additional types)
      
  - path: pkg/phase[PHASE]/wave[WAVE]/[feature]/[file2].go
    lines: ~[NUMBER] MAX  
    purpose: [SPECIFIC PURPOSE]
    contains:
      - FunctionName2 ONLY
      - NO helper functions
```

### Test Files
```yaml
test_files:
  - path: pkg/phase[PHASE]/wave[WAVE]/[feature]/[file]_test.go
    lines: ~[NUMBER] MAX
    coverage_target: 80%
    test_functions:
      - TestFunction1Basic  # ~30 lines
      - TestFunction2Basic  # ~30 lines
      # NO edge cases, NO benchmarks
```

## üì¶ Files to Import/Reuse

### From Previous Efforts (This Wave)
```yaml
this_wave_imports:
  - source: pkg/phase[PHASE]/wave[WAVE]/api/interfaces.go
    from_effort: 1
    usage: Implement Service interface
    
  - source: pkg/phase[PHASE]/wave[WAVE]/lib/client.go
    from_effort: 2
    usage: Use client for API calls
```

### From Previous Waves/Phases
```yaml
previous_work_imports:
  - source: pkg/phase1/common/logger/logger.go
    usage: Logging infrastructure
    
  - source: pkg/phase[PHASE]/wave[PREV]/lib/base.go
    usage: Extend base functionality
```

## üîó Dependencies

### Effort Dependencies
- **Must Complete First**: Effort [N] - [Reason]
- **Can Run in Parallel With**: Efforts [X, Y, Z]
- **Blocks**: Efforts [A, B] - [They need this effort's outputs]

### Technical Dependencies
- APIs from Effort 1 (contracts)
- Libraries from Effort 2 (shared code)
- [Other technical dependencies]

## üî¥ ATOMIC PR REQUIREMENTS (R220 - SUPREME LAW)

### üî¥üî¥üî¥ PARAMOUNT: Independent Mergeability (R307) üî¥üî¥üî¥
**This effort MUST be mergeable at ANY time, even YEARS later:**
- ‚úÖ Must compile when merged alone to main
- ‚úÖ Must NOT break any existing functionality
- ‚úÖ Must use feature flags for incomplete features
- ‚úÖ Must work even if next effort merges 6 months later
- ‚úÖ Must gracefully degrade if dependencies missing

### Feature Flags for This Effort
```yaml
feature_flags:
  - flag: "EFFORT_[NAME]_ENABLED"
    location: "config/features.yaml"
    default: false
    purpose: "Control activation of [feature]"
    activation: "Set true when [condition]"
```

### Stubs/Mocks Required
```yaml
stubs:
  - name: "Mock[ServiceName]"
    implements: "I[ServiceName]"
    replaces: "Real service from Effort [X]"
    behavior: "Returns default/success responses"
```

### PR Mergeability Checklist
- [ ] PR can merge to main independently
- [ ] Build passes with just this PR
- [ ] All tests pass in isolation
- [ ] Feature flags hide incomplete features
- [ ] Stubs replace missing dependencies
- [ ] No breaking changes to existing code
- [ ] Backward compatible with main

## üî¥ MANDATORY ADHERENCE CHECKPOINTS (R311)

### Before Starting:
```bash
echo "EFFORT SCOPE LOCKED:"
echo "‚úì Functions: EXACTLY [N] (list them)"
echo "‚úì Types: EXACTLY [N] (list them)"
echo "‚úì Endpoints: EXACTLY [N] (list them)"
echo "‚úì Tests: EXACTLY [N] basic tests"
echo "‚úó Validation: MINIMAL ONLY"
echo "‚úó Extra features: NONE"
echo "‚úó Optimizations: NONE"
```

### During Implementation:
```bash
# Check scope adherence after each component
FUNC_COUNT=$(grep -c "^func [A-Z]" *.go 2>/dev/null || echo 0)
if [ "$FUNC_COUNT" -gt [EXPECTED_COUNT] ]; then
    echo "‚ö†Ô∏è WARNING: Exceeding function count! Stop adding!"
fi
```

### If Addition Seems Necessary:
```markdown
## Justification for Addition
- **What needs adding**: [describe]
- **Why it's ESSENTIAL**: [not just nice to have]
- **What BREAKS without it**: [specific failure]
- **Line count of addition**: [estimate]
- **Decision**: [Add with justification / Skip for now]
```

## üìù Implementation Instructions

### Step-by-Step Guide
1. **Scope Acknowledgment**
   - Read and acknowledge DO NOT IMPLEMENT section
   - Extract exact function/type counts
   - Create .scope-acknowledgment file

2. **Implementation Order**
   - Start with [file1] - defines core types ONLY
   - Implement [file2] - EXACTLY the listed functions
   - Add [file3] - ONLY specified components
   - Write MINIMAL tests (basic cases only)

3. **Key Implementation Details**
   ```go
   // Example structure from wave plan
   type ServiceImpl struct {
       client *Client // From Effort 2
       logger *Logger // From Phase 1 common
   }
   
   // Must implement interface from Effort 1
   func (s *ServiceImpl) ProcessRequest(ctx context.Context, req *Request) (*Response, error) {
       // Implementation here
   }
   ```

4. **Integration Points**
   - Import contracts from `../api/`
   - Use shared libraries from `../lib/`
   - Follow patterns established in previous waves

## ‚úÖ Test Requirements

### Coverage Requirements
- **Minimum Coverage**: 80%
- **Critical Paths**: 100% coverage required
- **Error Handling**: All error cases must be tested

### Test Categories
```yaml
required_tests:
  unit_tests:
    - All public functions
    - Error conditions
    - Edge cases
    
  integration_tests:
    - API endpoint testing
    - Database interactions
    - External service mocking
    
  performance_tests:
    - Load testing for high-traffic endpoints
    - Memory usage validation
```

## üìè Size Constraints
**Target Size**: [NUMBER] lines (from wave plan)  
**Maximum Size**: 800 lines (HARD LIMIT)  
**Current Size**: [To be updated during implementation]  

### Size Monitoring Protocol
```bash
# Check size every ~200 lines
cd efforts/phase[PHASE]/wave[WAVE]/[effort]
$PROJECT_ROOT/tools/line-counter.sh

# If approaching 700 lines:
# 1. Alert Code Reviewer
# 2. Prepare for potential split
# 3. Focus on completing current functionality
```

## üèÅ Completion Criteria

### Implementation Checklist
- [ ] All files created as specified
- [ ] Size verified under 800 lines
- [ ] All imports properly referenced
- [ ] Interfaces from Effort 1 implemented
- [ ] Libraries from Effort 2 utilized

### Quality Checklist
- [ ] Test coverage ‚â•80%
- [ ] All tests passing
- [ ] No linting errors
- [ ] Error handling complete
- [ ] Logging added where appropriate

### Documentation Checklist
- [ ] Code comments for complex logic
- [ ] API documentation for exported functions
- [ ] README updated if needed
- [ ] Work log updated with progress

### Review Checklist
- [ ] Self-review completed
- [ ] Code committed and pushed
- [ ] Ready for Code Reviewer assessment
- [ ] No blocking issues

## üìä Progress Tracking

### Work Log
```markdown
## [DATE] - Session 1
- Created file1.go (150 lines)
- Implemented core logic
- Added unit tests

## [DATE] - Session 2
- Created file2.go (200 lines)
- Integrated with Effort 1 contracts
- Current total: 350 lines

[Continue updating during implementation]
```

## ‚ö†Ô∏è Important Notes

### Parallelization Reminder
[IF Can Parallelize = Yes]
- This effort can run simultaneously with efforts [X, Y, Z]
- No need to wait for those efforts to complete
- Ensure no shared state with parallel efforts

[IF Can Parallelize = No]
- This is a BLOCKING effort
- Other efforts depend on this completion
- Priority: Complete ASAP to unblock team

### Common Pitfalls to Avoid (R311 ENFORCEMENT)
1. **SCOPE CREEP**: Adding "helpful" features = AUTOMATIC FAILURE
2. **OVER-ENGINEERING**: Making it "production-ready" = 3-5X overrun
3. **ASSUMPTIONS**: Implementing what "seems needed" = VIOLATION
4. **Size Limit**: Monitor continuously with line-counter.sh
5. **Dependencies**: Import from correct efforts, not reimplement
6. **Test Coverage**: Basic tests only - no edge cases unless specified
7. **Isolation**: Stay in your effort directory
8. **Parallelization**: Don't create dependencies on parallel efforts

### Success Criteria Checklist
- [ ] Read and acknowledged DO NOT IMPLEMENT section
- [ ] Implemented EXACTLY the specified functions (no more)
- [ ] Created EXACTLY the specified types (no more)
- [ ] Wrote EXACTLY the specified tests (no more)
- [ ] Total lines under 800
- [ ] NO unauthorized features added
- [ ] Any additions have written justification
- [ ] Followed all scope boundaries

## üìö References

### Source Documents
- [Wave Implementation Plan](../../../phase-plans/PHASE-[PHASE]-WAVE-[WAVE]-IMPLEMENTATION-PLAN.md)
- [Phase Architecture](../../../phase-plans/PHASE-[PHASE]-ARCHITECTURE-PLAN.md)
- [Master Plan](../../../IMPLEMENTATION-PLAN.md)

### Code Examples
- [Previous Wave Implementation](../../wave[PREV]/)
- [Phase 1 Patterns](../../../phase1/)

### Standards
- [Coding Standards](../../../docs/coding-standards.md)
- [Testing Guide](../../../docs/testing-guide.md)

---

**Remember**: This plan was extracted from the wave plan. All headers, especially parallelization info, MUST match the wave plan exactly. The orchestrator depends on this information for spawning decisions.