# SPLIT-PLAN-004: CLI Commands
## Split 004 of 5: Command-Line Interface
**Planner**: Code Reviewer code-reviewer-1757726063 (sole planner for ALL splits)
**Parent Effort**: kind-cert-extraction

<!-- ORCHESTRATOR METADATA PLACEHOLDER - DO NOT REMOVE -->
<!-- The orchestrator will add infrastructure metadata below: -->
<!-- WORKING_DIRECTORY, BRANCH, REMOTE, BASE_BRANCH, etc. -->
<!-- SW Engineers MUST read this metadata to navigate to the correct directory -->
<!-- END PLACEHOLDER -->

## Boundaries (CRITICAL: All splits MUST reference SAME effort!)
- **Previous Split**: Split 003 of phase1/wave1/kind-cert-extraction
  - Path: efforts/phase1/wave1/kind-cert-extraction/split-003/
  - Branch: idpbuilder-oci-build-push/phase1/wave1/kind-cert-extraction-split-003
  - Summary: Build operations and utility functions
- **This Split**: Split 004 of phase1/wave1/kind-cert-extraction
  - Path: efforts/phase1/wave1/kind-cert-extraction/split-004/
  - Branch: idpbuilder-oci-build-push/phase1/wave1/kind-cert-extraction-split-004
- **Next Split**: Split 005 of phase1/wave1/kind-cert-extraction
  - Path: efforts/phase1/wave1/kind-cert-extraction/split-005/
  - Branch: idpbuilder-oci-build-push/phase1/wave1/kind-cert-extraction-split-005
- **File Boundaries**:
  - This Split Start: main.go
  - This Split End: pkg/cmd/ (all files)
  - Next Split Start: pkg/controllers/

## Files in This Split (EXCLUSIVE - no overlap with other splits)
### Main Entry Point
- main.go (~25 lines)

### Command Package (pkg/cmd/)
- pkg/cmd/root.go (~80 lines)
- pkg/cmd/version/root.go (~40 lines)

### Create Commands (pkg/cmd/create/)
- pkg/cmd/create/root.go (~270 lines)

### Get Commands (pkg/cmd/get/)
- pkg/cmd/get/root.go (~50 lines)
- pkg/cmd/get/clusters.go (~305 lines)
- pkg/cmd/get/secrets.go (~200 lines)
- pkg/cmd/get/packages.go (~120 lines)
- pkg/cmd/get/secrets_test.go (test file)

### Delete Commands (pkg/cmd/delete/)
- pkg/cmd/delete/root.go (~60 lines)

### Command Helpers (pkg/cmd/helpers/)
- pkg/cmd/helpers/logger.go (~40 lines)
- pkg/cmd/helpers/validation.go (~60 lines)
- pkg/cmd/helpers/validation_test.go (test file)

## Functionality
This split provides the complete CLI interface:
- Main application entry point
- Root command structure
- Create commands for resources
- Get commands for clusters, secrets, packages
- Delete commands for cleanup
- Version information
- Command validation helpers
- Logger initialization

## Dependencies
- **Split 001**: Uses certificate extraction functionality
- **Split 002**: Uses Kind cluster operations
- **Split 003**: Uses build and utility functions
- Integrates all previous splits into CLI

## Implementation Instructions
1. **Setup**:
   ```bash
   # Branch from Split 003
   cd efforts/phase1/wave1/kind-cert-extraction/split-004
   git checkout -b idpbuilder-oci-build-push/phase1/wave1/kind-cert-extraction-split-004
   
   # Merge previous splits
   git merge [split-003-branch]
   ```

2. **Implementation**:
   - Implement main.go entry point
   - Create complete command structure
   - Implement all CLI commands
   - Add command validation
   - Setup proper logging
   - Add help text and examples

3. **Integration**:
   - Wire certificate extraction (Split 001)
   - Connect Kind operations (Split 002)
   - Use build utilities (Split 003)
   - Create cohesive CLI experience

4. **Testing**:
   - Unit tests for command logic
   - Test command validation
   - Mock external dependencies
   - Test CLI argument parsing

5. **Validation**:
   ```bash
   # Measure size
   $PROJECT_ROOT/tools/line-counter.sh
   
   # Run tests
   go test ./pkg/cmd/...
   
   # Build CLI binary
   go build -o idpbuilder-cert-extractor .
   
   # Test CLI commands
   ./idpbuilder-cert-extractor --help
   ./idpbuilder-cert-extractor version
   ```

## Size Management
- **Target Size**: 600 lines
- **Hard Limit**: 800 lines
- **Measurement**: Use ${PROJECT_ROOT}/tools/line-counter.sh
- **Excluded**: Test files, generated code

## Feature Flags
- `CLI_ENABLED`: Master CLI enable flag
- Individual command flags as needed
- Commands gracefully disabled when flags off

## Quality Requirements
- Clear command structure and help text
- No stub implementations (R320)
- Test coverage >80%
- Proper error messages for users
- Consistent command patterns

## Integration Points
This split provides:
- Complete CLI interface for the application
- User-facing commands for all operations
- Integration point for all functionality
- Executable binary generation

## Success Criteria
- ✅ Complete CLI implementation
- ✅ All commands fully functional
- ✅ Tests passing with >80% coverage
- ✅ Size under 700 lines
- ✅ No stub implementations
- ✅ Binary builds and runs successfully
- ✅ Proper integration with Splits 001-003
- ✅ Help text and documentation complete