# ORCHESTRATOR STATE: WAITING_FOR_PROJECT_TEST_PLAN

## Overview
This state waits for the Code Reviewer to complete project-level test planning, then enforces R342 by transitioning to early branch creation.

## Entry Criteria
- Transitioned from SPAWN_CODE_REVIEWER_PROJECT_TEST_PLANNING
- Code Reviewer spawned for project test planning

## State Responsibilities

### 1. Check for Test Plan Completion
```bash
# Look for completed project test plan
if [ -f "PROJECT-TEST-PLAN.md" ]; then
    echo "‚úÖ Project test plan completed"
    TEST_READY=true
else
    echo "‚è≥ Waiting for project test plan..."
    TEST_READY=false
fi
```

### 2. Verify Test Artifacts
When tests are ready, verify:
```bash
# Check for required test artifacts
[ -f "PROJECT-TEST-PLAN.md" ] || { echo "‚ùå Missing test plan"; exit 1; }
[ -f "PROJECT-TEST-HARNESS.sh" ] || { echo "‚ö†Ô∏è Missing test harness"; }
[ -d "project-tests/" ] || { echo "‚ö†Ô∏è Missing test directory"; }
```

### 3. Update Planning File Tracking (R340)
```bash
# Record test plan location and metadata
yq -i '.planning_files.project_test_plan = "PROJECT-TEST-PLAN.md"' orchestrator-state.json
yq -i '.planning_files.project_test_author = "code-reviewer"' orchestrator-state.json
yq -i '.planning_files.project_test_timestamp = "'$(date -Iseconds)'"' orchestrator-state.json
yq -i '.planning_files.project_test_harness = "PROJECT-TEST-HARNESS.sh"' orchestrator-state.json
```

### 4. Enforce R342 - Transition to Early Branch Creation
```bash
if [ "$TEST_READY" = true ]; then
    echo "üî¥üî¥üî¥ R342 ENFORCEMENT: Creating integration branch for test storage"
    update_state "CREATE_PROJECT_INTEGRATION_BRANCH_EARLY"
    echo "üìç Tests will be stored in project-integration branch"
fi
```

## Exit Criteria
- Project test plan exists
- Test artifacts verified
- R340 metadata tracking complete
- State transitions to CREATE_PROJECT_INTEGRATION_BRANCH_EARLY (R342)

## Success Metrics
- ‚úÖ PROJECT-TEST-PLAN.md created
- ‚úÖ Test harness present
- ‚úÖ R340 planning file tracking complete
- ‚úÖ R342 early branch creation enforced

## Related Rules
- R340: Planning file metadata tracking
- R341: TDD - tests created before implementation
- R342: Early integration branch creation (SUPREME LAW)
- R287: TODO persistence