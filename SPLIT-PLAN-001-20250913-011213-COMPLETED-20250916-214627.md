# SPLIT-PLAN-001: Core Certificate Extraction
## Split 001 of 5: Certificate Extraction Foundation
**Planner**: Code Reviewer code-reviewer-1757726063 (sole planner for ALL splits)
**Parent Effort**: kind-cert-extraction

<!-- ORCHESTRATOR METADATA PLACEHOLDER - DO NOT REMOVE -->
<!-- The orchestrator will add infrastructure metadata below: -->
<!-- WORKING_DIRECTORY, BRANCH, REMOTE, BASE_BRANCH, etc. -->
<!-- SW Engineers MUST read this metadata to navigate to the correct directory -->
<!-- END PLACEHOLDER -->

## Boundaries (CRITICAL: All splits MUST reference SAME effort!)
- **Previous Split**: None (first split of THIS effort)
  - Path: N/A (this is Split 001)
  - Branch: N/A
- **This Split**: Split 001 of phase1/wave1/kind-cert-extraction
  - Path: efforts/phase1/wave1/kind-cert-extraction/split-001/
  - Branch: idpbuilder-oci-build-push/phase1/wave1/kind-cert-extraction-split-001
- **Next Split**: Split 002 of phase1/wave1/kind-cert-extraction
  - Path: efforts/phase1/wave1/kind-cert-extraction/split-002/
  - Branch: idpbuilder-oci-build-push/phase1/wave1/kind-cert-extraction-split-002
- **File Boundaries**:
  - This Split Start: pkg/certs/errors.go
  - This Split End: pkg/certs/storage_test.go
  - Next Split Start: pkg/kind/cluster.go

## Files in This Split (EXCLUSIVE - no overlap with other splits)
### Core Certificate Package (pkg/certs/)
- pkg/certs/errors.go (~70 lines)
- pkg/certs/extractor.go (~190 lines)
- pkg/certs/helpers.go (~90 lines)
- pkg/certs/kind_client.go (~165 lines)
- pkg/certs/storage.go (~120 lines)
- pkg/certs/errors_test.go (test file)
- pkg/certs/extractor_test.go (test file)
- pkg/certs/helpers_test.go (test file)
- pkg/certs/storage_test.go (test file)

### Foundation Files
- go.mod (foundation)
- go.sum (dependencies)
- Makefile (build configuration)
- .gitignore
- LICENSE
- README.md (documentation)
- .goreleaser.yaml (release config)

## Functionality
This split establishes the core certificate extraction functionality:
- Certificate error types and handling
- Certificate extraction from Kind clusters
- Certificate validation helpers
- Kind client for kubectl operations
- Certificate storage management
- Comprehensive test coverage for all components

## Dependencies
- None (foundational split)
- This split provides the base types and interfaces used by all other splits

## Implementation Instructions
1. **Setup**:
   ```bash
   # Create split directory structure
   mkdir -p efforts/phase1/wave1/kind-cert-extraction/split-001
   cd efforts/phase1/wave1/kind-cert-extraction/split-001
   
   # Initialize git for split
   git init
   git checkout -b idpbuilder-oci-build-push/phase1/wave1/kind-cert-extraction-split-001
   ```

2. **Implementation**:
   - Copy foundation files (go.mod, Makefile, etc.)
   - Implement pkg/certs package completely
   - Ensure all certificate extraction logic is functional
   - Add comprehensive error handling
   - Implement storage abstraction

3. **Testing**:
   - Unit tests for all certificate functions
   - Mock Kind client for testing
   - Test error scenarios
   - Validate certificate parsing

4. **Validation**:
   ```bash
   # Measure size
   $PROJECT_ROOT/tools/line-counter.sh
   
   # Run tests
   go test ./pkg/certs/...
   
   # Build verification
   go build ./...
   ```

## Size Management
- **Target Size**: 650 lines
- **Hard Limit**: 800 lines
- **Measurement**: Use ${PROJECT_ROOT}/tools/line-counter.sh
- **Excluded**: Test files, generated code, vendor/

## Feature Flags
- `KIND_CERT_EXTRACTION_ENABLED`: Main feature flag
- All functionality must gracefully degrade when disabled

## Quality Requirements
- All functions must have error handling
- No stub implementations (R320)
- Test coverage >80%
- No panics in production code
- Clear documentation for public APIs

## Integration Points
This split provides these interfaces for other splits:
- `CertExtractor` interface
- `CertStorage` interface
- `KindClient` interface
- Error types for certificate operations
- Certificate validation utilities

## Success Criteria
- ✅ All certificate extraction code implemented
- ✅ Tests passing with >80% coverage
- ✅ Size under 700 lines (non-test, non-generated)
- ✅ No stub implementations
- ✅ Builds independently
- ✅ Feature flag integration complete