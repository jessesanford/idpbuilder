# Software Factory 2.0 Rule Registry

## Rule ID Format
- **Format**: R{XXX}.{Y}.{Z}
  - XXX: Rule number (001-999)
  - Y: Variation (0-9)
  - Z: Patch (0-9)

## 🔴🔴🔴 SUPREME LAWS - ABSOLUTE HIGHEST PRIORITY 🔴🔴🔴

**These rules supersede ALL other rules and CANNOT be violated for ANY reason:**

1. **R234.0.0** - Mandatory State Traversal (HIGHEST SUPREME LAW - NO SKIPPING STATES!)
2. **R221.0.0** - Bash Directory Reset Protocol (CD IN EVERY BASH COMMAND!)
3. **R208.0.0** - Orchestrator CD Before Spawn (SPAWN WITHOUT CD = -100% FAIL!)
4. **R235.0.0** - Mandatory Pre-Flight Verification (NO WORK IN WRONG LOCATION!)
5. **STATE MACHINE** - SOFTWARE-FACTORY-STATE-MACHINE.md (ABSOLUTE AUTHORITY)
6. **R280.0.0** - Main Branch Protection (NEVER MODIFY MAIN!)
7. **R021.0.0** - Orchestrator Never Stops (CONTINUOUS OPERATION!)
8. **R231.0.0** - Continuous Operation Through Transitions (STATES ARE VERBS!)
9. **R232.0.0** - TodoWrite Pending Items Override (PENDING = COMMANDS!)
10. **R288.0.0** - Mandatory State File Updates (UPDATE ON EVERY TRANSITION!)
11. **R281.0.0** - Complete State File Initialization (ALL PHASES/WAVES/EFFORTS!)
12. **R283.0.0** - Complete File Reading (READ EVERY LINE - NO PARTIAL READS!)
13. **R236.0.0** - DEPRECATED - Consolidated into R290
14. **R237.0.0** - DEPRECATED - Consolidated into R290
15. **R290.0.0** - State Rule Reading and Verification (SUPREME LAW #3 - READ AND VERIFY STATE RULES!)
16. **R299.0.0** - DEPRECATED - Consolidated into R300
17. **R300.0.0** - Comprehensive Fix Management Protocol (ALL FIXES TO EFFORT BRANCHES - SUPREME LAW!)
18. **R321.0.0** - Immediate Backport During Integration (FIX AT SOURCE IMMEDIATELY - NO DEFERRALS!)
19. **R220.0.0** - Atomic PR Design Requirement (EVERY EFFORT = ONE ATOMIC PR TO MAIN!)
20. **R302.0.0** - Comprehensive Split Tracking Protocol (Meticulous tracking of split operations)
21. **R303.0.0** - Phase/Wave Document Location Protocol (Centralized document storage)
22. **R309.0.0** - NEVER Create Efforts in SF Repo (PARAMOUNT LAW - -100% FOR VIOLATION!)
23. **R312.0.0** - Git Config Immutability Protocol (SUPREME LAW - ROOT-OWNED + READONLY CONFIGS FOR DOUBLE PROTECTION!)
24. **R323.0.0** - Mandatory Final Artifact Build (NO PROJECT SUCCESS WITHOUT DELIVERABLE!)
25. **R329.0.0** - Orchestrator Never Performs Git Merges (SUPREME LAW - INTEGRATION AGENT HANDLES ALL MERGES!)

## Rule Categories

### Critical Rules (R001-R010) - ALWAYS LOADED
- R001.0.0 - Pre-Flight Checks
- R002.0.0 - Agent Acknowledgment Protocol
- R003.0.0 - Performance Grading System
- R004.0.0 - State Machine Navigation
- R005.0.0 - Context Recovery
- R006.0.0 - Orchestrator Never Writes Code
- R007.0.0 - Size Limit Compliance (800 lines)
- R008.0.0 - Monitoring Frequency Requirements
- R009.0.0 - Integration Branch Creation
- R010.0.0 - Wrong Location Handling

### Process Rules (R011-R030)
- R011.0.0 - Agent Startup Requirements
- R012.0.0 - Working Copy Creation (Sparse Clone)
- R013.0.0 - Git Operations
- R014.0.0 - Branch Naming Convention (phase/wave/effort)
- R015.0.0 - Commit Message Format
- R016.0.0 - TODO State Management
- R017.0.0 - Checkpoint Creation
- R018.0.0 - Progress Reporting
- R019.0.0 - Error Recovery
- R020.0.0 - State Transitions
- R021.0.0 - Orchestrator Never Stops (🔴 SUPREME LAW #7)
- R022.0.0 - Architect Size Verification Protocol

### Quality Gates (R031-R050)
- R031.0.0 - Mandatory Code Review
- R032.0.0 - Test Coverage Requirements
- R033.0.0 - Architect Review Gates
- R034.0.0 - Integration Requirements
- R035.0.0 - Phase Completion Testing
- R036.0.0 - PR Readiness Assessment
- R037.0.0 - Pattern Compliance
- R038.0.0 - Security Review
- R039.0.0 - Performance Validation
- R040.0.0 - Documentation Requirements

### Agent-Specific Rules (R051-R100)
- R051.0.0 - Orchestrator State Ownership
- R052.0.0 - Agent Spawning Protocol
- R053.0.0 - Parallelization Decisions
- R054.0.0 - Implementation Plan Creation
- R055.0.0 - Review Decision Making
- R056.0.0 - Split Plan Creation
- R057.0.0 - Wave Review Authority
- R058.0.0 - Phase Assessment Responsibility
- R059.0.0 - Pattern Validation
- R060.0.0 - Test Implementation

### State-Specific Rules (R101-R150)
- R101.0.0 - INIT State Rules
- R102.0.0 - WAVE_START Rules
- R103.0.0 - SPAWN_AGENTS Rules
- R104.0.0 - MONITOR Rules
- R105.0.0 - WAVE_COMPLETE Rules
- R106.0.0 - IMPLEMENTATION Rules
- R107.0.0 - MEASURE_SIZE Rules
- R108.0.0 - CODE_REVIEW Rules
- R109.0.0 - PLANNING Rules
- R110.0.0 - WAVE_REVIEW Rules

### Performance Metrics (R151-R170)
- R151.0.0 - Parallel Agent Spawning Timing and Acknowledgment
- R152.0.0 - Implementation Speed Requirements (>50 lines/hour)
- R153.0.0 - Review Turnaround and Quality Metrics
- R154.0.0 - Test Coverage Achievement
- R155.0.0 - State Transition Speed
- R156.0.0 - Error Recovery Time
- R157.0.0 - Integration Success Rate
- R158.0.0 - Architecture Pattern Compliance Rate
- R159.0.0 - Documentation Completeness
- R160.0.0 - Overall Completion Time

### Utility and Hook Management (R171-R180)
- R171.0.0 - PreCompact Hook Configuration
- R172.0.0 - Utility Script Execution
- R173.0.0 - State Preservation Protocol
- R174.0.0 - Context Recovery Detection
- R175.0.0 - Manual Utility Usage
- R176.0.0 - Workspace Isolation Requirement
- R177.0.0 - Agent Working Directory Enforcement
- R178.0.0 - Effort Directory Structure
- R179.0.0 - Integration Phase Isolation
- R180.0.0 - Workspace Violation Recovery

### Orchestrator Workspace Preparation (R181-R185)
- R181.0.0 - Orchestrator Workspace Setup Responsibility
- R182.0.0 - Sparse Clone Requirement
- R183.0.0 - Branch Creation Protocol
- R184.0.0 - Effort Branch Naming Scheme
- R185.0.0 - Workspace Verification Before Spawn

### Automatic Compaction Detection (R186)
- R186.0.0 - Mandatory Compaction Detection in Pre-Flight Checks

### TODO State Persistence Requirements
- R287.0.0 - Comprehensive TODO Persistence Protocol (Consolidates R187-R190)
- R187.0.0 - [DEPRECATED - See R287] Mandatory TODO Save Triggers
- R188.0.0 - [DEPRECATED - See R287] TODO Save Frequency Requirements
- R189.0.0 - [DEPRECATED - See R287] TODO File Commit Protocol
- R190.0.0 - [DEPRECATED - See R287] TODO Recovery Verification

### Target Repository Management (R191-R195)
- R191.0.0 - Target Repository Configuration
- R192.0.0 - Repository Separation Enforcement
- R193.0.0 - Effort Clone Protocol
- R194.0.0 - Remote Branch Tracking
- R195.0.0 - Branch Push Verification

### Agent Lifecycle and Configuration (R196-R203)
- R196.0.0 - Base Branch Selection from Config
- R197.0.0 - One Agent Per Effort Rule
- R198.0.0 - Line Counter Tool Usage
- R199.0.0 - Single Reviewer for Split Planning
- R200.0.0 - Measure Only Effort Changeset
- R201.0.0 - Line Counter Tool Location
- R202.0.0 - Single Agent Per Split Sequential Execution
- R203.0.0 - State-Aware Agent Startup and Acknowledgment
- R204.0.0 - Orchestrator Split Infrastructure Creation
- R205.0.0 - SW Engineer Split Directory Navigation
- R206.0.0 - State Machine Transition Validation
- R207.0.0 - Split Boundary Validation Protocol
- R208.0.0 - Orchestrator Working Directory Spawn Protocol (🔴 SUPREME LAW #3)
- R310.0.0 - Split Scope Strict Adherence Protocol (🚨🚨🚨 BLOCKING)

### Orchestrator Memory Management (R217-R218)
- R217.0.0 - Post-Transition Rule Re-Acknowledgment Protocol (CRITICAL)
- R218.0.0 - Orchestrator Parallel Code Reviewer Spawning for Effort Planning

### Code Reviewer Planning Enhancement (R219)
- R219.0.0 - Code Reviewer Dependency-Aware Effort Planning

### Atomic PR Design (R220)
- R220.0.0 - Atomic PR Design Requirement (🔴 SUPREME LAW - Every effort = one atomic PR to main)

### Bash Directory Management (R221)
- R221.0.0 - Bash Directory Reset Protocol (🔴 SUPREME LAW #2 - CD IN EVERY COMMAND!)

### Code Review Gate Requirement (R222)
- R222.0.0 - Code Review Gate Requirement (BLOCKING - No wave completion without ALL reviews passing)

### State Machine Visualization and Continuity (R230-R237, R290)
- R230.0.0 - State Machine Visualization Requirement
- R231.0.0 - Continuous Operation Through Transitions (🔴 SUPREME LAW #8)
- R232.0.0 - TodoWrite Pending Items Override (🔴 SUPREME LAW #9)
- R233.0.0 - All States Require Immediate Action (CRITICAL)
- R234.0.0 - Mandatory State Traversal (🔴 SUPREME LAW #1 - HIGHEST!)
- R235.0.0 - Mandatory Pre-Flight Verification (🔴 SUPREME LAW #4)
- R236.0.0 - DEPRECATED - Consolidated into R290
- R237.0.0 - DEPRECATED - Consolidated into R290
- R290.0.0 - State Rule Reading and Verification (🔴 SUPREME LAW #3)

### Repository and State Management (R014, R251-R259)
- R014.0.0 - Branch Naming Convention (Mandatory project prefix for all branches)
- R251.0.0 - Repository Separation Law
- R288.0.0 - Mandatory State File Updates (🔴 SUPREME LAW #10)
- R288.0.0 - Mandatory State File Commit Push (CRITICAL)
- R254.0.0 - Agent Error Reporting
- R255.0.0 - Post Agent Work Verification
- R256.0.0 - Mandatory Phase Assessment Gate
- R257.0.0 - Mandatory Phase Assessment Report
- R258.0.0 - Mandatory Wave Review Report
- R259.0.0 - Mandatory Phase Integration After Fixes

### Integration Rules (R260-R270)
- R260.0.0 - Integration Agent Core Requirements (INTEGRATION_DIR acknowledgment)
- R261.0.0 - Integration Planning Requirements
- R262.0.0 - Merge Operation Protocols (CRITICAL)
- R263.0.0 - Integration Documentation Requirements
- R264.0.0 - Work Log Tracking Requirements
- R265.0.0 - Integration Testing Requirements
- R266.0.0 - Upstream Bug Documentation Protocol (CRITICAL)
- R267.0.0 - Integration Agent Grading Criteria
- R268.0.0 - Orchestrator Integration Agent Spawn Protocol
- R269.0.0 - Code Reviewer Merge Plan No Execution
- R270.0.0 - No Integration Branches as Sources (CRITICAL)

### Production Delivery Rules (R271-R280) - CRITICAL FOR SUCCESS
- R271.0.0 - Mandatory Production-Ready Validation (CRITICAL)
- R272.0.0 - Integration Testing Branch Requirement (BLOCKING)
- R273.0.0 - Runtime-Specific Validation (MANDATORY)
- R274.0.0 - Production Readiness Checklist (BLOCKING)
- R275.0.0 - Deployment Verification (MANDATORY)
- R276.0.0 - Runbook Requirement (MANDATORY)
- R277.0.0 - Continuous Build Verification (MANDATORY)
- R278.0.0 - External User Validation (BLOCKING)
- R279.0.0 - MASTER-PR-PLAN Requirement (CRITICAL)
- R280.0.0 - Main Branch Protection (🔴 SUPREME LAW #6)
- R281.0.0 - Complete State File Initialization (🔴 SUPREME LAW #11)
- R282.0.0 - Phase Integration Protocol
- R283.0.0 - Complete File Reading (🔴 SUPREME LAW #12)
- R288.0.0 - State File Update and Commit Protocol | BLOCKING | State Management, Persistence
- R289.0.0 - Orphaned State Detection and Prevention | BLOCKING | State Machine Integrity
- R290.0.0 - State Rule Reading and Verification (🔴 SUPREME LAW #3)
- R291.0.0 - Integration Demo Requirement | BLOCKING | Integration Validation
- R292.0.0 - DEPRECATED - Consolidated into R300
- R293.0.0 - Integration Report Distribution Protocol | BLOCKING | Fix Distribution
- R294.0.0 - Fix Plan Archival Protocol | BLOCKING | Plan Management
- R295.0.0 - SW Engineer Spawn Clarity Protocol | SUPREME | Agent Communication
- R296.0.0 - Deprecated Branch Marking Protocol | BLOCKING | Split Management, Integration Safety
- R297.0.0 - Architect Split Detection Protocol | BLOCKING | Size Compliance, Split Recognition
- R298.0.0 - DEPRECATED - Consolidated into R300
- R299.0.0 - DEPRECATED - Consolidated into R300
- R300.0.0 - Comprehensive Fix Management Protocol | 🔴 SUPREME LAW | Consolidates R299, R240, R292, R298 - ALL fixes to effort branches
- R301.0.0 - File Naming Collision Prevention | BLOCKING | Prevents file overwrites during parallel operations
- R302.0.0 - Comprehensive Split Tracking Protocol | 🚨 BLOCKING | Meticulous tracking of all split operations and relationships
- R303.0.0 - Phase/Wave Document Location Protocol | 🚨 BLOCKING | Centralized storage of phase/wave documents in phase-plans directory
- R304.0.0 - Mandatory Line Counter Enforcement | 🔴 SUPREME LAW | ONLY use line-counter.sh with correct base branch
- R305.0.0 - SW Engineer Self-Monitoring Protocol | BLOCKING | Continuous size monitoring during implementation
- R307.0.0 - Independent Branch Mergeability | 🔴 PARAMOUNT LAW | Every branch must be independently mergeable
- R308.0.0 - Incremental Branching Strategy | 🔴 SUPREME LAW | Core tenant of trunk-based development
- R309.0.0 - NEVER Create Efforts in SF Repo | 🔴 PARAMOUNT LAW | Automatic -100% failure for violations
- R310.0.0 - Split Scope Strict Adherence Protocol | 🚨🚨🚨 BLOCKING | Prevents 3-5X overruns from vague split plans
- R311.0.0 - Effort Scope Strict Adherence Protocol | 🚨🚨🚨 BLOCKING | Prevents over-engineering in regular efforts, -100% for violations
- R312.0.0 - Git Config Immutability Protocol | 🔴🔴🔴 SUPREME LAW | DOUBLE PROTECTION: root:root ownership + 444 permissions for unbreakable effort isolation
- R313.0.0 - [DEPRECATED - Merged into R322 Part A] | ⚠️ DEPRECATED | Now part of R322 comprehensive checkpoint rule
- R314.0.0 through R318.0.0 - Reserved for future rules
- R319.0.0 - Orchestrator Never Measures Code | 🚨🚨🚨 BLOCKING | Orchestrator NEVER uses line-counter.sh or assesses code - delegate ALL to Code Reviewers
- R320.0.0 - No Stub Implementations | 🚨🚨🚨 BLOCKING | ANY stub implementation = CRITICAL BLOCKER = FAILED REVIEW (-50% penalty)
- R321.0.0 - Immediate Backport During Integration | 🔴🔴🔴 SUPREME LAW | ALL fixes during integration MUST be immediately backported to source branches (-100% for violations)
- R322.0.0 - Mandatory Orchestrator Checkpoints | 🔴🔴🔴 SUPREME LAW | Comprehensive checkpoint rule: spawns (Part A), reviews (Part B), assessments (Part C), monitoring (Part D) - MUST stop and wait for /continue-orchestrating (-100% for violations)
- R323.0.0 - Mandatory Final Artifact Build | 🚨🚨🚨 BLOCKING | NO project can be SUCCESS without built deliverable artifact (-50% to -100% penalty)
- R324.0.0 - State File Update Before Stop | 🔴🔴🔴 SUPREME LAW | MUST update current_state to new state BEFORE stopping to prevent infinite loops (-100% for violations)
- R325.0.0 - Atomic State Transitions | 🔴🔴🔴 SUPREME LAW | State transitions must be atomic operations
- R326.0.0 - Split File Placement Protocol | 🔴🔴🔴 SUPREME LAW | NEVER create split-XXX/ subdirectories - files go in standard project directories (-100% for violations)
- R327.0.0 - Mandatory Re-Integration After Fixes | 🔴🔴🔴 SUPREME LAW | After ANY fixes to source branches, MUST delete and re-run ENTIRE integration from scratch (-100% for violations)
- R328.0.0 - Integration Freshness Validation | 🚨🚨🚨 BLOCKING | MUST verify integration branch freshness before merging - stale branches cause lost fixes (-30% to -50% penalty)
- R329.0.0 - Orchestrator Never Performs Git Merges | 🚨🚨🚨 BLOCKING | Orchestrator MUST spawn Integration Agent for ALL merges - NO EXCEPTIONS (-100% for violations)
